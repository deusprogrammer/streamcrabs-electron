(this["webpackJsonptwitch-tools"]=this["webpackJsonptwitch-tools"]||[]).push([[0],{44:function(e,t,a){},45:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(35),i=a.n(r),o=(a(44),a(6)),c=a(7),l=a(9),u=a(8),h=(a(45),a(38)),d=a(4),m=a(2),p=a.n(m),f=a(3),g=a(14),v=a(0),b=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).connect=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.ws=new g.w3cwebsocket("ws://localhost:8081"),n.ws.onopen=function(){n.interval&&clearInterval(n.interval),n.ws.send(JSON.stringify({type:"PANEL_INIT",from:"PANEL",name:"DEATH_COUNTER"})),n.interval=setInterval((function(){n.ws.send(JSON.stringify({type:"PANEL_PING",from:"PANEL",name:"DEATH_COUNTER"}))}),2e4)},n.ws.onmessage=function(){var e=Object(f.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=JSON.parse(t.data),console.log("EVENT: "+JSON.stringify(a,null,5)),"DEATH_COUNT"===a.type&&n.onDeath(a.eventData.count);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.ws.onclose=function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket is closed. Reconnect will be attempted in 5 second.",t.reason),setTimeout((function(){n.connect()}),5e3);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.ws.onerror=function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Socket encountered error: ",t.message,"Closing socket"),n.ws.close();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();case 5:case"end":return e.stop()}}),e)}))),n.onDeath=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n.setState((function(t){return{deaths:-1!==e?e:t.deaths+1,textScale:1}}));var t=1,a=setInterval((function(){n.state.textScale<=2&&t>0&&n.setState((function(e){return{textScale:Math.min(e.textScale+.1,2)}})),n.state.textScale>=1&&t<0&&n.setState((function(e){return{textScale:Math.max(e.textScale-.1,1)}})),n.state.textScale>=2&&t>0&&(t=-1),n.state.textScale<=1&&t<0&&clearInterval(a)}),10)},n.ws=null,n.interval=null,n.state={deaths:0,textScale:1},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.connect()}},{key:"render",value:function(){return Object(v.jsx)("div",{style:{height:"100vh",width:"100vw",userSelect:"none"},className:"App",children:Object(v.jsxs)("span",{style:{fontWeight:"bolder",fontSize:"".concat(32*this.state.textScale,"pt"),WebkitTextStroke:"2px black",WebkitTextFillColor:"white",lineHeight:"100vh",height:"100vh"},children:["Deaths: ",this.state.deaths]})})}}]),a}(s.a.Component),y=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).connect=Object(f.a)(p.a.mark((function t(){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=new g.w3cwebsocket("ws://localhost:8081")).onopen=function(){a.send(JSON.stringify({type:"PANEL_INIT",from:"PANEL",name:"REQUESTS"})),e.interval&&clearInterval(e.interval),e.interval=setInterval((function(){a.send(JSON.stringify({type:"PANEL_PING",from:"PANEL",name:"REQUESTS"}))}),2e4)},a.onmessage=function(){var t=Object(f.a)(p.a.mark((function t(a){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"REQUEST"===(n=JSON.parse(a.data)).type&&e.setState({requestList:n.eventData.requestList});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a.onclose=function(){var t=Object(f.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Socket is closed. Reconnect will be attempted in 5 second.",a.reason),e.setState({mobs:[]}),setTimeout(Object(f.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.connect();case 1:case"end":return t.stop()}}),t)}))),5e3);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a.onerror=function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Socket encountered error: ",t.message,"Closing socket"),a.close();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();case 5:case"end":return t.stop()}}),t)}))),e.showQueue=function(){e.setState({mode:"QUEUE"}),setTimeout((function(){e.setState({mode:"NEXT_UP"})}),1e4)},e.interval=null,e.state={mode:"NEXT_UP",requestList:[]},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.connect(),setInterval((function(){e.showQueue()}),6e4)}},{key:"render",value:function(){return Object(v.jsxs)("div",{style:{height:"100vh",width:"100vw",userSelect:"none",position:"relative"},className:"App",children:[Object(v.jsx)("div",{style:{width:"100vw",position:"absolute",bottom:"0px",left:"0px",textAlign:"center",fontSize:"20pt",WebkitTextStroke:"1px black",WebkitTextFillColor:"white"},onClick:this.showQueue,children:this.state.requestList.length>0?Object(v.jsxs)("marquee",{children:["Next up: ",this.state.requestList[this.state.requestList.length-1].request," from ",this.state.requestList[this.state.requestList.length-1].requester]}):Object(v.jsx)("marquee",{children:"No requests so far.  Make a request by donating!"})}),Object(v.jsx)("div",{style:{width:"100vw",position:"absolute",bottom:"0px",left:"0px",textAlign:"center"},children:Object(v.jsxs)("div",{className:"QUEUE"===this.state.mode?"open":"closed",style:{maxWidth:"50%",margin:"auto",padding:"0px 5px",backgroundColor:"gray",color:"white"},children:[Object(v.jsx)("strong",{children:"Coming up:"}),this.state.requestList.slice().reverse().slice(0,3).map((function(e,t){return Object(v.jsxs)("div",{style:{color:0===t?"yellow":"white"},children:[t+1,": ",e.request," from ",e.requester]},"entry-".concat(t))}))]})})]})}}]),a}(s.a.Component),w=(new URLSearchParams(window.location.search),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).timerCallback=function(){n.videoElement&&n.videoElement.current&&(n.videoElement.current.paused||n.videoElement.current.ended)||(n.computeFrame(),n.timeOut=setTimeout((function(){n.timerCallback()}),0))},n.computeFrame=function(){if(n.videoElement.current){n.ctx1.drawImage(n.videoElement.current,0,0,n.state.vw,n.state.vh);for(var e=n.ctx1.getImageData(0,0,n.state.vw,n.state.vh),t=e.data.length,a=0;a<t;a+=4){var s=e.data[a+0],r=e.data[a+1],i=e.data[a+2];r<=177&&s<=177&&i<=177&&(e.data[a+3]=0)}n.ctx2.putImageData(e,0,0)}},n.videoElement=s.a.createRef(),n.canvasElement1=s.a.createRef(),n.canvasElement2=s.a.createRef(),n.ctx1=null,n.ctx2=null,n.timeOut=null,n.state={averageColor:{r:0,g:0,b:0},vh:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),vw:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.videoElement.current.addEventListener("ended",(function(){e.timeOut&&clearTimeout(e.timeOut),e.props.onComplete("badapple")})),this.ctx1=this.canvasElement1.current.getContext("2d"),this.ctx2=this.canvasElement2.current.getContext("2d"),this.videoElement.current.addEventListener("play",(function(){e.timerCallback()}),!1),window.onresize=function(){e.setState({vh:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),vw:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)})},this.videoElement.current.play()}},{key:"render",value:function(){return Object(v.jsxs)("div",{style:{overflow:"hidden"},children:[Object(v.jsx)("video",{style:{display:"none"},src:"".concat("","/videos/badapple.mp4"),controls:!1,crossOrigin:"anonymous",ref:this.videoElement}),Object(v.jsx)("canvas",{height:this.state.vh,width:this.state.vw,style:{display:"none"},ref:this.canvasElement1}),Object(v.jsx)("canvas",{height:this.state.vh,width:this.state.vw,style:{border:"1px solid black"},ref:this.canvasElement2})]})}}]),a}(s.a.Component)),j=a(36),x=(new URLSearchParams(window.location.search),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).birdup=Object(f.a)(p.a.mark((function t(){var a,n,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.stages[0].current.style.display="block",a=new Audio("".concat("","/sounds/birdup.mp3")),t.next=4,a.play();case 4:n=1,s=setInterval((function(){if(n>=e.stages.length)return clearInterval(s),void setTimeout((function(){var t,a=Object(j.a)(e.stages);try{for(a.s();!(t=a.n()).done;){t.value.current.style.display="none"}}catch(n){a.e(n)}finally{a.f()}setTimeout((function(){e.playing=!1,e.props.onComplete("birdup")}),5e3)}),2e3);e.stages[n++].current.style.display="block"}),300);case 6:case"end":return t.stop()}}),t)}))),e.playing=!1,e.textRef=s.a.createRef(),e.imageRef1=s.a.createRef(),e.imageRef2=s.a.createRef(),e.imageRef3=s.a.createRef(),e.imageRef4=s.a.createRef(),e.imageRef5=s.a.createRef(),e.imageRef6=s.a.createRef(),e.stages=[e.textRef,e.imageRef1,e.imageRef2,e.imageRef3,e.imageRef4,e.imageRef5,e.imageRef6],e.birdQueue=[],e.state={},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.birdup()}},{key:"render",value:function(){return Object(v.jsxs)("div",{style:{height:"100vh",width:"100vw",userSelect:"none",position:"relative"},className:"App",children:[Object(v.jsx)("img",{alt:"birdup",style:{position:"absolute",fontSize:"20px",right:"0px",bottom:"0px",height:"20%",zIndex:"101",display:"none"},ref:this.imageRef1,src:"".concat("","/images/birdup.png")}),Object(v.jsx)("img",{alt:"birdup",style:{position:"absolute",fontSize:"20px",right:"0px",bottom:"0px",height:"40%",zIndex:"102",display:"none"},ref:this.imageRef2,src:"".concat("","/images//birdup.png")}),Object(v.jsx)("img",{alt:"birdup",style:{position:"absolute",fontSize:"20px",right:"0px",bottom:"0px",height:"60%",zIndex:"103",display:"none"},ref:this.imageRef3,src:"".concat("","/images//birdup.png")}),Object(v.jsx)("img",{alt:"birdup",style:{position:"absolute",fontSize:"20px",right:"0px",bottom:"0px",height:"80%",zIndex:"104",display:"none"},ref:this.imageRef4,src:"".concat("","/images//birdup.png")}),Object(v.jsx)("img",{alt:"birdup",style:{position:"absolute",fontSize:"20px",right:"0px",bottom:"0px",height:"100%",zIndex:"105",display:"none"},ref:this.imageRef5,src:"".concat("","/images//birdup.png")}),Object(v.jsx)("img",{alt:"birdup",style:{position:"absolute",fontSize:"20px",right:"0px",bottom:"0px",height:"120%",zIndex:"106",display:"none"},ref:this.imageRef6,src:"".concat("","/images//birdup.png")}),Object(v.jsx)("div",{style:{position:"absolute",fontFamily:"Cooper Black",WebkitTextStroke:"5px black",WebkitTextFillColor:"#CE01E2",bottom:"0px",left:"50%",transform:"translate(-50%, -50%)",fontSize:"70pt",zIndex:"200",display:"none"},ref:this.textRef,children:"BIRD UP!"})]})}}]),a}(s.a.Component)),O=a(15),k=a.n(O),S=function(e){var t,a,s,r=!1,i=!1,o=null,c=1,l=1440;function u(){this.load.image("ground","/images/ground.png"),this.load.image("water","/images/water.png"),this.load.spritesheet("slime","/images/slime-sprite.png",{frameWidth:80,frameHeight:80}),this.load.spritesheet("link","/images/link.png",{frameWidth:80,frameHeight:160}),this.load.audio("bgm",["/sounds/bgm.mp3"]),this.load.audio("battle",["/sounds/battle.wav"]),this.load.audio("hurt",["/sounds/hurt.wav"]),this.load.audio("die",["/sounds/die.wav"]),this.load.audio("fanfare",["/sounds/fanfare.wav"])}function h(){var n=this,c=e.variable,u=this.game.scale.width/l,h=this.textures.get("ground").getSourceImage().width*u,d=this.textures.get("ground").getSourceImage().height*u,m=this.textures.get("water").getSourceImage().width*u,p=[(100*Math.random()+200)*u,(100*Math.random()+200)*u];t=this.physics.add.staticGroup(),a=this.physics.add.staticGroup(),this.anims.create({key:"wobble",frames:this.anims.generateFrameNumbers("slime",{start:0,end:2}),frameRate:10,repeat:-1}),this.anims.create({key:"idle",frames:this.anims.generateFrameNumbers("link",{start:0,end:0}),frameRate:10,repeat:-1}),this.anims.create({key:"hurt",frames:this.anims.generateFrameNumbers("link",{start:1,end:1}),frameRate:10,repeat:-1});var f=this.sound.add("bgm",{loop:!0,volume:.25}),g=this.sound.add("battle",{loop:!1}),v=this.sound.add("hurt",{loop:!1,volume:3}),b=this.sound.add("die",{loop:!1}),y=this.sound.add("fanfare",{loop:!1,volume:1});b.once("complete",(function(){n.scene.stop(),n.sys.game.destroy(!0),clearTimeout(o),e.onComplete()})),y.once("complete",(function(){n.scene.stop(),n.sys.game.destroy(!0),clearTimeout(o),e.onComplete()})),g.play(),f.play();var w=this.game.scale.height-(d-p[1]),j=this.physics.add.sprite(h+200,w,"link");j.setOrigin(0,1),j.setBounce(.5),j.setScale(u),j.setGravityY(300),j.refreshBody(),j.body.setCollideWorldBounds(!0),j.anims.play("idle",!0),this.physics.add.collider(j,t);for(var x=0;x<c;x++){var O=this.physics.add.sprite(.5*-x,Math.random()*(this.game.scale.height-100)-(d-p[0]),"slime");O.setScale(u),O.setBounce(Math.min(1,Math.random()+.5)),O.body.setGravity(400),O.anims.play("wobble",!0),O.setVelocityX(300*Math.random()),this.physics.add.collider(O,t),this.physics.add.overlap(j,O,(function(){r||(r=!0,v.play()),j.play("hurt"),j.setVelocity(500,-50),j.body.useDamping=!0,j.setDrag(.99)}),null,this),this.physics.add.overlap(j,a,(function(){i||(i=!0,b.play()),f.stop(),j.play("hurt"),j.setVelocity(0,50)}),null,this)}for(var k=0;k<this.game.scale.width;){var S=a.create(0,0,"water");S.setScale(u),S.setOrigin(0,1),S.x=k,S.y=this.game.scale.height+100,S.refreshBody(),k+=m}for(var E=0;E<2;E++){var N=E*(h+200),R=p[E],T=t.create(N,this.game.scale.height+R,"ground");T.setOrigin(0,1),T.setScale(u),T.refreshBody()}(s=this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,e.message,{fontSize:"30pt",stroke:"#000",strokeThickness:5})).setOrigin(.5,.5),o=setTimeout((function(){f.stop(),y.play()}),1e4)}function d(){s.setScale(s.scale+.01*c),s.tint=16777215*Math.random(),(s.scale>2||s.scale<.5)&&(c*=-1)}return Object(n.useEffect)((function(){!function(){var e={type:k.a.AUTO,width:"100vw",height:"100vh",transparent:!0,parent:"phaser",scene:{preload:u,create:h,update:d},physics:{default:"arcade",arcade:{gravity:{y:200}}}};new k.a.Game(e)}()}),[]),Object(v.jsx)("div",{children:Object(v.jsx)("div",{id:"phaser"})})},E=function(e){var t,a=0,s=[],r=!1,i=1,o=1440;function c(){this.load.image("ground","/images/ground.png"),this.load.image("water","/images/water.png"),this.load.spritesheet("yoshiGreen","/images/yoshi/yoshi-walk.png",{frameWidth:128,frameHeight:128}),this.load.spritesheet("yoshiBlue","/images/yoshi/yoshi-walk-blue.png",{frameWidth:128,frameHeight:128}),this.load.spritesheet("yoshiPurple","/images/yoshi/yoshi-walk-purple.png",{frameWidth:128,frameHeight:128}),this.load.spritesheet("yoshiPink","/images/yoshi/yoshi-walk-pink.png",{frameWidth:128,frameHeight:128}),this.load.spritesheet("yoshiBlack","/images/yoshi/yoshi-walk-black.png",{frameWidth:128,frameHeight:128}),this.load.spritesheet("yoshiYellow","/images/yoshi/yoshi-walk-yellow.png",{frameWidth:128,frameHeight:128}),this.load.audio("fanfare",["/sounds/yoshi/yoshi-fanfare.mp3"]),this.load.audio("badum",["/sounds/yoshi/yoshi-tongue.mp3"])}function l(){var n=this,i=this.game.scale.width/o,c=e.variable;this.anims.create({key:"walkGreen",frames:this.anims.generateFrameNumbers("yoshiGreen",{start:0,end:9}),frameRate:15,repeat:-1}),this.anims.create({key:"walkPurple",frames:this.anims.generateFrameNumbers("yoshiPurple",{start:0,end:9}),frameRate:15,repeat:-1}),this.anims.create({key:"walkPink",frames:this.anims.generateFrameNumbers("yoshiPink",{start:0,end:9}),frameRate:15,repeat:-1}),this.anims.create({key:"walkBlue",frames:this.anims.generateFrameNumbers("yoshiBlue",{start:0,end:9}),frameRate:15,repeat:-1}),this.anims.create({key:"walkBlack",frames:this.anims.generateFrameNumbers("yoshiBlack",{start:0,end:9}),frameRate:15,repeat:-1}),this.anims.create({key:"walkYellow",frames:this.anims.generateFrameNumbers("yoshiYellow",{start:0,end:9}),frameRate:15,repeat:-1});var l=this.sound.add("fanfare",{loop:!0,volume:1}),u=this.sound.add("badum",{loop:!1,volume:1}),h=Math.ceil(100*(Math.log2(c)+1)),d=Math.ceil(5e3/c),m=["Green","Purple","Blue","Pink","Yellow","Black"],p=this.physics.add.sprite(this.game.scale.width+256,0,"ground");p.setOrigin(0,0),p.displayHeight=this.game.scale.height,a=c,l.play();for(var f=function(e){var t=m[Math.floor(Math.random()*m.length)],r=n.physics.add.sprite(-e*d,Math.random()*n.game.scale.height,"yoshi".concat(t));r.setScale(i),r.body.setGravity(0),r.anims.play("walk".concat(t),!0),r.setVelocityX(h),s.push(r),n.physics.add.overlap(r,p,(function(){u.play(),r.destroy(),a--}),null,n)},g=0;g<c;g++)f(g);setTimeout((function(){r=!0}),15e3),(t=this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,e.message,{fontSize:"30pt",stroke:"#000",strokeThickness:5})).setOrigin(.5,.5)}function u(){a<=0&&r&&(this.scene.stop(),this.sys.game.destroy(!0),e.onComplete&&e.onComplete()),t.setScale(t.scale+.01*i),t.tint=16777215*Math.random(),(t.scale>2||t.scale<.5)&&(i*=-1)}return Object(n.useEffect)((function(){!function(){var e={type:k.a.AUTO,width:"100vw",height:"100vh",transparent:!0,parent:"phaser",scene:{preload:c,create:l,update:u},physics:{default:"arcade",arcade:{gravity:{y:0}}}};new k.a.Game(e)}()}),[]),Object(v.jsx)("div",{children:Object(v.jsx)("div",{id:"phaser"})})},N=function(e){var t,a=0,s=!1,r=1,i=1440;function o(){var t=this;this.load.image("ground","/images/ground.png"),e.config.sprites.forEach((function(e,a){t.load.spritesheet("sprite".concat(a),e.file,{frameWidth:e.frameWidth,frameHeight:e.frameHeight})})),this.load.audio("music",[e.config.music.file]),this.load.audio("leaving",[e.config.leavingSound.file])}function c(){var n=this,r=this.game.scale.width/i,o=e.variable;e.config.sprites.forEach((function(e,t){n.anims.create({key:"animation".concat(t),frames:n.anims.generateFrameNumbers("sprite".concat(t),{start:e.startFrame,end:e.endFrame}),frameRate:e.frameRate,repeat:-1})}));var c=this.sound.add("music",{loop:!0,volume:e.config.music.volume}),l=this.sound.add("leaving",{loop:!1,volume:e.config.leavingSound.volume}),u=100*Math.ceil(Math.log2(o)+1),h=Math.ceil(5e3/o),d=this.physics.add.sprite(this.game.scale.width+256,0,"ground");d.setOrigin(0,0),d.displayHeight=this.game.scale.height,a=o,c.play();for(var m=function(t){var s=Math.floor(Math.random()*e.config.sprites.length),i=n.physics.add.sprite(-t*h,Math.random()*n.game.scale.height,"sprite".concat(s));i.setScale(r),i.body.setGravity(0),i.anims.play("animation".concat(s),!0),i.setVelocityX(u),n.physics.add.overlap(i,d,(function(){l.play(),i.destroy(),a--}),null,n)},p=0;p<o;p++)m(p);setTimeout((function(){s=!0}),15e3),(t=this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,e.message,{fontSize:"30pt",stroke:"#000",strokeThickness:5})).setOrigin(.5,.5)}function l(){a<=0&&s&&(this.scene.stop(),this.sys.game.destroy(!0),e.onComplete&&e.onComplete()),t.setScale(t.scale+.01*r),t.tint=16777215*Math.random(),(t.scale>2||t.scale<.5)&&(r*=-1)}return Object(n.useEffect)((function(){!function(){var e={type:k.a.AUTO,width:"100vw",height:"100vh",transparent:!0,parent:"phaser",scene:{preload:o,create:c,update:l},physics:{default:"arcade",arcade:{gravity:{y:0}}}};new k.a.Game(e)}()}),[]),Object(v.jsx)("div",{children:Object(v.jsx)("div",{id:"phaser"})})},R=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).timerCallback=function(){n.videoElement&&n.videoElement.current&&(n.videoElement.current.paused||n.videoElement.current.ended)||(n.computeFrame(),n.timeOut=setTimeout((function(){n.timerCallback()}),0))},n.computeFrame=function(){if(n.videoElement.current){n.ctx1.drawImage(n.videoElement.current,0,0,n.state.vw,n.state.vh);for(var e=n.ctx1.getImageData(0,0,n.state.vw,n.state.vh),t=e.data.length,a=0;a<t;a+=4){var s=e.data[a+0],r=e.data[a+1],i=e.data[a+2];"green"===n.props.chromaKey?r>s+i&&(e.data[a+3]=0):"red"===n.props.chromaKey?s>r+i&&(e.data[a+3]=0):"blue"===n.props.chromaKey&&i>s+r&&(e.data[a+3]=0)}n.ctx2.putImageData(e,0,0)}},n.videoElement=s.a.createRef(),n.canvasElement1=s.a.createRef(),n.canvasElement2=s.a.createRef(),n.ctx1=null,n.ctx2=null,n.timeOut=null,n.state={averageColor:{r:0,g:0,b:0},vh:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),vw:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.videoElement.current.addEventListener("ended",(function(){e.timeOut&&clearTimeout(e.timeOut),e.props.onComplete("randomcustomvideo")})),this.ctx1=this.canvasElement1.current.getContext("2d"),this.ctx2=this.canvasElement2.current.getContext("2d"),this.videoElement.current.addEventListener("play",(function(){e.timerCallback()}),!1),window.onresize=function(){e.setState({vh:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),vw:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)})},this.videoElement.current.volume=this.props.volume,this.videoElement.current.play()}},{key:"render",value:function(){Math.ceil(7*Math.random());return Object(v.jsxs)("div",{style:{overflow:"hidden"},children:[Object(v.jsx)("video",{style:{display:"none"},src:this.props.url,controls:!1,crossOrigin:"anonymous",ref:this.videoElement}),Object(v.jsx)("canvas",{height:this.state.vh,width:this.state.vw,style:{display:"none"},ref:this.canvasElement1}),Object(v.jsx)("canvas",{height:this.state.vh,width:this.state.vw,style:{border:"1px solid black"},ref:this.canvasElement2}),Object(v.jsx)("span",{style:{position:"absolute",bottom:"0px",left:"50%",transform:"translateX(-50%)",fontSize:"20pt",WebkitTextStroke:"1px black",WebkitTextFillColor:"white"},children:this.props.message.map((function(e){return Object(v.jsxs)(s.a.Fragment,{children:[e,Object(v.jsx)("br",{})]})}))})]})}}]),a}(s.a.Component),T=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).connect=Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new g.w3cwebsocket("ws://localhost:8081")).onopen=function(){t.send(JSON.stringify({type:"PANEL_INIT",from:"PANEL",name:"MULTI"})),n.interval&&clearInterval(n.interval),n.interval=setInterval((function(){t.send(JSON.stringify({type:"PANEL_PING",from:"PANEL",name:"MULTI"}))}),2e4)},t.onmessage=function(){var e=Object(f.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=JSON.parse(t.data),["BIRDUP","VIDEO","BADAPPLE","DYNAMIC"].includes(a.type)){e.next=4;break}return console.log("FILTERED OUT"),e.abrupt("return");case 4:console.log("Received: "+JSON.stringify(a,null,5)),n.queue.push(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.onclose=function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket is closed. Reconnect will be attempted in 5 second.",t.reason),n.setState({mobs:[]}),setTimeout(Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.connect();case 1:case"end":return e.stop()}}),e)}))),5e3);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.onerror=function(){var e=Object(f.a)(p.a.mark((function e(a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Socket encountered error: ",a.message,"Closing socket"),t.close();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();case 5:case"end":return e.stop()}}),e)}))),n.consumer=Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.queue.length<=0||n.state.currentEvent)){e.next=2;break}return e.abrupt("return");case 2:t=n.queue[0],n.queue=n.queue.slice(1),n.playing=!0,n.setState({currentEvent:t});case 6:case"end":return e.stop()}}),e)}))),n.reset=function(){n.setState({currentEvent:null})},n.queue=[],n.interval=null,n.state={currentEvent:null},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.connect(),setInterval(this.consumer,1e3)}},{key:"render",value:function(){var e=null;if(console.log(JSON.stringify(this.state.currentEvent,null,5)),!this.state.currentEvent)return Object(v.jsx)("div",{});switch(this.state.currentEvent.type){case"BADAPPLE":e=Object(v.jsx)(w,{onComplete:this.reset,requester:this.state.currentEvent.eventData.requester});break;case"VIDEO":e=Object(v.jsx)(R,{onComplete:this.reset,message:this.state.currentEvent.eventData.message,requester:this.state.currentEvent.eventData.requester,url:this.state.currentEvent.eventData.url,mediaName:this.state.currentEvent.eventData.mediaName,volume:this.state.currentEvent.eventData.volume,chromaKey:this.state.currentEvent.eventData.chromaKey});break;case"BIRDUP":e=Object(v.jsx)(x,{onComplete:this.reset,message:this.state.currentEvent.eventData.message,requester:this.state.currentEvent.eventData.requester});break;case"DYNAMIC":"YOSHI"===this.state.currentEvent.eventData.raidTheme?e=Object(v.jsx)(E,{onComplete:this.reset,message:this.state.currentEvent.eventData.message,variable:this.state.currentEvent.eventData.variable}):"ZELDA2"===this.state.currentEvent.eventData.raidTheme?e=Object(v.jsx)(S,{onComplete:this.reset,message:this.state.currentEvent.eventData.message,variable:this.state.currentEvent.eventData.variable}):"STORED"===this.state.currentEvent.eventData.raidTheme&&(e=Object(v.jsx)(N,{onComplete:this.reset,message:this.state.currentEvent.eventData.message,variable:this.state.currentEvent.eventData.variable,config:this.state.currentEvent.eventData.raidCustomTheme}));break;case"DEFAULT":this.reset()}return Object(v.jsx)("div",{children:Object(v.jsx)("div",{className:"multContainer",children:e})})}}]),a}(s.a.Component),C=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).connect=Object(f.a)(p.a.mark((function t(){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=new g.w3cwebsocket("ws://localhost:8081")).onopen=function(){a.send(JSON.stringify({type:"PANEL_INIT",from:"PANEL",name:"SOUND_PLAYER"})),e.interval&&clearInterval(e.interval),e.interval=setInterval((function(){a.send(JSON.stringify({type:"PANEL_PING",from:"PANEL",name:"SOUND_PLAYER"}))}),2e4)},a.onmessage=function(){var t=Object(f.a)(p.a.mark((function t(a){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"AUDIO"===(n=JSON.parse(a.data)).type&&e.soundQueue.push({requester:n.eventData.requester,mediaName:n.eventData.mediaName,url:n.eventData.url,volume:n.eventData.volume,message:n.eventData.message});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a.onclose=function(){var t=Object(f.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Socket is closed. Reconnect will be attempted in 5 second.",a.reason),e.setState({mobs:[]}),setTimeout(Object(f.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.connect();case 1:case"end":return t.stop()}}),t)}))),5e3);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a.onerror=function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Socket encountered error: ",t.message,"Closing socket"),a.close();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();case 5:case"end":return t.stop()}}),t)}))),e.consumer=Object(f.a)(p.a.mark((function t(){var a,n,s,r,i,o,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.soundQueue.length<=0||e.consumerLocked)){t.next=2;break}return t.abrupt("return");case 2:return a=e.soundQueue[0],n=a.requester,s=a.mediaName,r=a.url,i=a.volume,o=a.message,e.consumerLocked=!0,e.soundQueue=e.soundQueue.slice(1),e.setState({requester:n,mediaName:s,message:o}),c=new Audio(r),e.setState({soundPlaying:!0}),c.addEventListener("ended",(function(){e.setState({soundPlaying:!1}),setTimeout((function(){e.consumerLocked=!1}),5e3)})),c.volume=i,t.next=12,c.play();case 12:case"end":return t.stop()}}),t)}))),e.consumerLocked=!1,e.interval=null,e.soundQueue=[],e.state={soundPlaying:!1,requester:null,mediaName:null,message:null},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.connect(),setInterval(this.consumer,0)}},{key:"render",value:function(){return Object(v.jsx)("div",{style:{height:"100vh",width:"100vw",userSelect:"none"},className:"App",children:this.state.soundPlaying?Object(v.jsxs)("div",{children:[Object(v.jsx)("img",{style:{position:"absolute",width:"100px",height:"100px",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},src:"".concat("","/images/speaker.png")}),Object(v.jsx)("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"20pt",WebkitTextStroke:"1px black",WebkitTextFillColor:"white"},children:this.state.message.map((function(e){return Object(v.jsxs)(s.a.Fragment,{children:[e,Object(v.jsx)("br",{})]})}))})]}):null})}}]),a}(s.a.Component),D=a(17),I={YOSHI:{message:"Incoming raid from ${raider} with a party of ${raidSize}!",sprites:[{file:"/images/yoshi/yoshi-walk.png",startFrame:0,endFrame:9,frameWidth:128,frameHeight:128,frameRate:15},{file:"/images/yoshi/yoshi-walk-black.png",startFrame:0,endFrame:9,frameWidth:128,frameHeight:128,frameRate:15},{file:"/images/yoshi/yoshi-walk-blue.png",startFrame:0,endFrame:9,frameWidth:128,frameHeight:128,frameRate:15},{file:"/images/yoshi/yoshi-walk-pink.png",startFrame:0,endFrame:9,frameWidth:128,frameHeight:128,frameRate:15},{file:"/images/yoshi/yoshi-walk-purple.png",startFrame:0,endFrame:9,frameWidth:128,frameHeight:128,frameRate:15},{file:"/images/yoshi/yoshi-walk-yellow.png",startFrame:0,endFrame:9,frameWidth:128,frameHeight:128,frameRate:15}],music:{file:"/sounds/yoshi/yoshi-fanfare.mp3",volume:1},leavingSound:{file:"/sounds/yoshi/yoshi-tongue.mp3",volume:1}},SKULLMAN:{message:"HOLY SHIT! ${raider} raided with a party of ${raidSize}!",sprites:[{file:"/images/skullman/skullman-walk.png",startFrame:0,endFrame:9,frameWidth:99,frameHeight:128,frameRate:15}],music:{file:"/sounds/skullman/battle.mp3",volume:1},leavingSound:{file:"/sounds/skullman/ash-groovy.mp3",volume:3}},CHAIR:{message:"CHEESE IT UP! ${raider} raided with a party of ${raidSize}!",sprites:[{file:"/images/chair/cheesesteak-walk.png",startFrame:0,endFrame:5,frameWidth:128,frameHeight:128,frameRate:15},{file:"/images/chair/yuu.png",startFrame:24,endFrame:29,frameWidth:128,frameHeight:128,frameRate:15},{file:"/images/chair/tanako.png",startFrame:30,endFrame:41,frameWidth:128,frameHeight:128,frameRate:15}],music:{file:"/sounds/chair/music.mp3",volume:1},leavingSound:{file:"/sounds/chair/cheeseitup.wav",volume:1}}},L=a(37),M=a.n(L),F=function(){var e=Object(f.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.a.get("https://deusprogrammer.com/api/twitch/raid-configs/".concat(t),{headers:{"X-Access-Token":localStorage.getItem("accessToken")}});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(n.useState)(!1),t=Object(D.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)("daddyfartbux"),i=Object(D.a)(r,2),o=i[0],c=i[1],l=Object(n.useState)(100),u=Object(D.a)(l,2),h=u[0],d=u[1],m=Object(n.useState)("CUSTOM"),g=Object(D.a)(m,2),b=g[0],y=g[1],w=Object(n.useState)("SKULLMAN"),j=Object(D.a)(w,2),x=j[0],O=j[1],k=Object(n.useState)({}),R=Object(D.a)(k,2),T=R[0],C=R[1];Object(n.useEffect)(Object(f.a)(p.a.mark((function e(){var t,a,n,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new URLSearchParams(window.location.search),a=t.get("theme"),n=t.get("key"),c(t.get("raider")?t.get("raider"):"daddyfartbux"),d(t.get("raidSize")?t.get("raidSize"):10),y(t.get("theme")?t.get("theme"):"YOSHI"),O(t.get("key")?t.get("key"):"SKULLMAN"),"STORED"!==a){e.next=12;break}return e.next=10,F(n);case 10:s=e.sent,C(s);case 12:case"end":return e.stop()}}),e)}))),[]);var L=null;switch(b){case"YOSHI":L=Object(v.jsx)(E,{raider:o,raidSize:h,onComplete:function(){s(!1)}});break;case"ZELDA":L=Object(v.jsx)(S,{raider:o,raidSize:h,onComplete:function(){s(!1)}});break;case"CUSTOM":L=Object(v.jsx)(N,{raider:o,raidSize:h,config:I[x],onComplete:function(){s(!1)}});case"STORED":L=Object(v.jsx)(N,{raider:o,raidSize:h,config:T,onComplete:function(){s(!1)}})}return Object(v.jsx)("div",{children:a?L:Object(v.jsxs)("div",{children:[Object(v.jsxs)("p",{children:["Testing with size ",Object(v.jsx)("b",{children:h})," and raider ",Object(v.jsx)("b",{children:o})]}),Object(v.jsx)("button",{onClick:function(){s(!0)},children:"Click to Test"}),Object(v.jsx)("h3",{children:"Debug"}),Object(v.jsx)("pre",{children:JSON.stringify(T,null,5)})]})})},P=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return Object(v.jsx)(h.a,{children:Object(v.jsxs)(d.c,{children:[Object(v.jsx)(d.a,{path:"".concat("","/tools/raid-test"),component:A,exact:!0}),Object(v.jsx)(d.a,{path:"".concat("","/overlays/multi"),component:T,exact:!0}),Object(v.jsx)(d.a,{path:"".concat("","/overlays/death-counter"),component:b,exact:!0}),Object(v.jsx)(d.a,{path:"".concat("","/overlays/sound-player"),component:C,exact:!0}),Object(v.jsx)(d.a,{path:"".concat("","/overlays/requests"),component:y,exact:!0})]})})}}]),a}(s.a.Component),H=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,76)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),n(e),s(e),r(e),i(e)}))};window.speechSynthesis.onvoiceschanged=function(){window.maleVoice=window.speechSynthesis.getVoices().find((function(e){return"Microsoft David - English (United States)"===e.name})),window.femaleVoice=window.speechSynthesis.getVoices().find((function(e){return"Microsoft Zira - English (United States)"===e.name})),console.log("MAN:   "+window.maleVoice),console.log("WOMAN: "+window.femaleVoice)},i.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(P,{})}),document.getElementById("root")),H()}},[[75,1,2]]]);
//# sourceMappingURL=main.aa7ead74.chunk.js.map